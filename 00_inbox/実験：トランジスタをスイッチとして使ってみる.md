
実験日：2025/12/28

まずは[[トランジスタ]]について調べる。

## まずはトランジスタ無し

いつものやつ（基準）

```
Arduino D8 ── 300Ω ── LED ── GND
```

```cpp
void setup() {
  // put your setup code here, to run once:
  pinMode(8, OUTPUT);
}

void loop() {
  // put your main code here, to run repeatedly:
  digitalWrite(8, HIGH);
}
```

- [[LED]]：点く
- 電流：[[Arduino]]が全部出している

## トランジスタをスイッチにする

NPN: 2N3904を使用する。
平たい方と向かい合って、左から順番に
- エミッタ
- ベース
- コレクタ

配線は以下の通り。

```
D8 ── 1kΩ ── B
C ── LED ── 330Ω ── 5V
E ── GND
```

```cpp
pinMode(8, OUTPUT);
digitalWrite(8, HIGH);
```

- Arduino：ベースに少し電流
- トランジスタ：C-E が通電
- LED：点く

👉️
- Arduinoは「命令」だけ
- 電流の主役はトランジスタ

**ベースに電流が流れると、コレクタ - エミッタ が導通する**

## ベースを外す（核心）

今度はB の線を抜く。

LEDは消える。

なぜなら、トランジスタは、ベースに電流が流れないと何もしないから。

## イレギュラー発生！

ベースに電圧をかけているD8を引っこ抜いて、1kΩ抵抗に触れたらLEDが点いた。

試しに、この抵抗からジャンプワイヤーを伸ばしてみると、ワイヤーに手を近づけるほどLEDの光が強くなる。
面白い。

### これは何が起きている？

現在、ベースに対して何も繋がっていない。
これは浮いている(floating)状態である。

この状態のベースは「高感度のアンテナ」になる。

- 体が持つ静電気
- 周囲の 50/60Hz
- ブレッドボードや配線の寄生容量
などがベースに入り、わずかなベース電流が流れる。

### 対策できる

このような意図しない動作を起こす状況は対策をすることが出来る。

ベースが浮かないように、ベースをGNDに落とす抵抗を追加するのだ。
これはプルダウンを追加すると言う。

配線イメージ
```
D8 ── 1k ── B
            |
           100k
            |
           GND
```

これでD8を抜いても、ベースは勝手にONしなくなる。

### この現象は結構大事

回路は「繋がっていない = 0」じゃない。

浮いた入力は**何でも拾う**。

スイッチ入力のチャタリングやノイズ対策、ギターなどではハム対策に直結する。

プログラミングで言うと、前もってケアする丁寧さで品質が決まることから、エラーハンドリングに似ていると感じた（主観）。

## ベース抵抗を変えてみる
### 結果の予測
1kΩ → 10kΩ
- LED：まだ点く。少し弱いか、変わらない。
100kΩにする
- LED：点かない or かなり弱い

なぜなら、ベース電流が小さすぎると、トランジスタは動かない。

### 実際の結果
プルダウンを付けたまま
- 100kΩまでは変わらず。
- 1MΩは点かない

プルダウンを外す
- 1MΩは明るさが少し弱くなった。

100kΩのプルダウンを付けたままだと、分圧が発生して、さすがにベース電流が足りなくなったんだと思う。
## Arduinoの出力を弱めてみる

```cpp
analogWrite(8, 50);   // 小さな命令
```

LEDはうっすら点く

```cpp
analogWrite(8, 200);  // 大きな命令
```

LEDは明るい

### 失敗

上記では上手く動かなかった。

なぜなら、8はPWMじゃないから。

Arduinoで、「9~」のように記載されているところが調節できる箇所。

以下のようにすれば可能である。

```cpp
const int PWM_PIN = 9;

void setup() {
  pinMode(PWM_PIN, OUTPUT);
}

void loop() {
  analogWrite(PWM_PIN, 30);   // 暗い
  delay(1000);
  analogWrite(PWM_PIN, 200);  // 明るい
  delay(1000);
}
```

見事、明るくなったり暗くなったりした。

ベース電流が十分に足りている場合、C-E 間は十分に流れるが、足りていない場合は完全に開ききらないのである。

## 実験は成功だ！

トランジスタをスイッチとして使うことが出来た。

- トランジスタは、ベース電流が無いと何もしない
- ベースは電圧ではなく電流で動く
- ベース電流が十分に足りているときだけ、C-E間は完全に開く
